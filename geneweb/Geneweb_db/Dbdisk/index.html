<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dbdisk (geneweb.Geneweb_db.Dbdisk)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">geneweb</a> &#x00BB; <a href="../index.html">Geneweb_db</a> &#x00BB; Dbdisk</nav><header class="odoc-preamble"><h1>Module <code><span>Geneweb_db.Dbdisk</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-dsk_person"><a href="#type-dsk_person" class="anchor"></a><code><span><span class="keyword">type</span> dsk_person</span><span> = <span><span>(int, int, int)</span> <a href="../../Def/index.html#type-gen_person">Def.gen_person</a></span></span></code></div><div class="spec-doc"><p>Extended person's entry in the base</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dsk_ascend"><a href="#type-dsk_ascend" class="anchor"></a><code><span><span class="keyword">type</span> dsk_ascend</span><span> = <span>int <a href="../../Def/index.html#type-gen_ascend">Def.gen_ascend</a></span></span></code></div><div class="spec-doc"><p>Person's ascendants entry in the base</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dsk_union"><a href="#type-dsk_union" class="anchor"></a><code><span><span class="keyword">type</span> dsk_union</span><span> = <span>int <a href="../../Def/index.html#type-gen_union">Def.gen_union</a></span></span></code></div><div class="spec-doc"><p>Person's union entry in the base</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dsk_family"><a href="#type-dsk_family" class="anchor"></a><code><span><span class="keyword">type</span> dsk_family</span><span> = <span><span>(int, int, int)</span> <a href="../../Def/index.html#type-gen_family">Def.gen_family</a></span></span></code></div><div class="spec-doc"><p>Family's entry in the base</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dsk_couple"><a href="#type-dsk_couple" class="anchor"></a><code><span><span class="keyword">type</span> dsk_couple</span><span> = <span>int <a href="../../Def/index.html#type-gen_couple">Def.gen_couple</a></span></span></code></div><div class="spec-doc"><p>Family's couple entry in the base</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dsk_descend"><a href="#type-dsk_descend" class="anchor"></a><code><span><span class="keyword">type</span> dsk_descend</span><span> = <span>int <a href="../../Def/index.html#type-gen_descend">Def.gen_descend</a></span></span></code></div><div class="spec-doc"><p>Family's descendants entry in the base</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dsk_title"><a href="#type-dsk_title" class="anchor"></a><code><span><span class="keyword">type</span> dsk_title</span><span> = <span>int <a href="../../Def/index.html#type-gen_title">Def.gen_title</a></span></span></code></div><div class="spec-doc"><p>Nobility title in the base</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-record_access"><a href="#type-record_access" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a record_access</span></span><span> = </span><span>{</span></code><ol><li id="type-record_access.load_array" class="def record field anchored"><a href="#type-record_access.load_array" class="anchor"></a><code><span>load_array : <span>unit <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-record_access.get" class="def record field anchored"><a href="#type-record_access.get" class="anchor"></a><code><span>get : <span>int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>;</span></code></li><li id="type-record_access.get_nopending" class="def record field anchored"><a href="#type-record_access.get_nopending" class="anchor"></a><code><span>get_nopending : <span>int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>;</span></code></li><li id="type-record_access.len" class="def record field anchored"><a href="#type-record_access.len" class="anchor"></a><code><span><span class="keyword">mutable</span> len : int;</span></code></li><li id="type-record_access.output_array" class="def record field anchored"><a href="#type-record_access.output_array" class="anchor"></a><code><span>output_array : <span><span class="xref-unresolved">Stdlib</span>.out_channel <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-record_access.clear_array" class="def record field anchored"><a href="#type-record_access.clear_array" class="anchor"></a><code><span>clear_array : <span>unit <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Type that define the functions to use to access and manipulate with database arrays.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-string_person_index"><a href="#type-string_person_index" class="anchor"></a><code><span><span class="keyword">type</span> string_person_index</span><span> = </span><span>{</span></code><ol><li id="type-string_person_index.find" class="def record field anchored"><a href="#type-string_person_index.find" class="anchor"></a><code><span>find : <span>int <span class="arrow">&#45;&gt;</span></span> <span>int list</span>;</span></code></li><li id="type-string_person_index.cursor" class="def record field anchored"><a href="#type-string_person_index.cursor" class="anchor"></a><code><span>cursor : <span>string <span class="arrow">&#45;&gt;</span></span> int;</span></code></li><li id="type-string_person_index.next" class="def record field anchored"><a href="#type-string_person_index.next" class="anchor"></a><code><span>next : <span>int <span class="arrow">&#45;&gt;</span></span> int;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Data structure for optimised search throughout index by name (surname or first name). Considers also patched persons.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-visible_record_access"><a href="#type-visible_record_access" class="anchor"></a><code><span><span class="keyword">type</span> visible_record_access</span><span> = </span><span>{</span></code><ol><li id="type-visible_record_access.v_write" class="def record field anchored"><a href="#type-visible_record_access.v_write" class="anchor"></a><code><span>v_write : <span>unit <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-visible_record_access.v_get" class="def record field anchored"><a href="#type-visible_record_access.v_get" class="anchor"></a><code><span>v_get : <span><span>(<span><a href="#type-dsk_person">dsk_person</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-perm"><a href="#type-perm" class="anchor"></a><code><span><span class="keyword">type</span> perm</span><span> = </span></code><ol><li id="type-perm.RDONLY" class="def variant constructor anchored"><a href="#type-perm.RDONLY" class="anchor"></a><code><span>| </span><span><span class="constructor">RDONLY</span></span></code></li><li id="type-perm.RDRW" class="def variant constructor anchored"><a href="#type-perm.RDRW" class="anchor"></a><code><span>| </span><span><span class="constructor">RDRW</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-base_data"><a href="#type-base_data" class="anchor"></a><code><span><span class="keyword">type</span> base_data</span><span> = </span><span>{</span></code><ol><li id="type-base_data.persons" class="def record field anchored"><a href="#type-base_data.persons" class="anchor"></a><code><span>persons : <span><a href="#type-dsk_person">dsk_person</a> <a href="#type-record_access">record_access</a></span>;</span></code></li><li id="type-base_data.ascends" class="def record field anchored"><a href="#type-base_data.ascends" class="anchor"></a><code><span>ascends : <span><a href="#type-dsk_ascend">dsk_ascend</a> <a href="#type-record_access">record_access</a></span>;</span></code></li><li id="type-base_data.unions" class="def record field anchored"><a href="#type-base_data.unions" class="anchor"></a><code><span>unions : <span><a href="#type-dsk_union">dsk_union</a> <a href="#type-record_access">record_access</a></span>;</span></code></li><li id="type-base_data.visible" class="def record field anchored"><a href="#type-base_data.visible" class="anchor"></a><code><span>visible : <a href="#type-visible_record_access">visible_record_access</a>;</span></code></li><li id="type-base_data.families" class="def record field anchored"><a href="#type-base_data.families" class="anchor"></a><code><span>families : <span><a href="#type-dsk_family">dsk_family</a> <a href="#type-record_access">record_access</a></span>;</span></code></li><li id="type-base_data.couples" class="def record field anchored"><a href="#type-base_data.couples" class="anchor"></a><code><span>couples : <span><a href="#type-dsk_couple">dsk_couple</a> <a href="#type-record_access">record_access</a></span>;</span></code></li><li id="type-base_data.descends" class="def record field anchored"><a href="#type-base_data.descends" class="anchor"></a><code><span>descends : <span><a href="#type-dsk_descend">dsk_descend</a> <a href="#type-record_access">record_access</a></span>;</span></code></li><li id="type-base_data.strings" class="def record field anchored"><a href="#type-base_data.strings" class="anchor"></a><code><span>strings : <span>string <a href="#type-record_access">record_access</a></span>;</span></code></li><li id="type-base_data.particles_txt" class="def record field anchored"><a href="#type-base_data.particles_txt" class="anchor"></a><code><span>particles_txt : <span>string list</span>;</span></code></li><li id="type-base_data.particles" class="def record field anchored"><a href="#type-base_data.particles" class="anchor"></a><code><span>particles : <span><span class="xref-unresolved">Re</span>.re <span class="xref-unresolved">Stdlib</span>.Lazy.t</span>;</span></code></li><li id="type-base_data.bnotes" class="def record field anchored"><a href="#type-base_data.bnotes" class="anchor"></a><code><span>bnotes : <a href="../../Def/index.html#type-base_notes">Def.base_notes</a>;</span></code></li><li id="type-base_data.bdir" class="def record field anchored"><a href="#type-base_data.bdir" class="anchor"></a><code><span>bdir : string;</span></code></li><li id="type-base_data.perm" class="def record field anchored"><a href="#type-base_data.perm" class="anchor"></a><code><span>perm : <a href="#type-perm">perm</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Data part of database</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-base_func"><a href="#type-base_func" class="anchor"></a><code><span><span class="keyword">type</span> base_func</span><span> = </span><span>{</span></code><ol><li id="type-base_func.person_of_key" class="def record field anchored"><a href="#type-base_func.person_of_key" class="anchor"></a><code><span>person_of_key : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int option</span>;</span></code></li><li id="type-base_func.persons_of_name" class="def record field anchored"><a href="#type-base_func.persons_of_name" class="anchor"></a><code><span>persons_of_name : <span>string <span class="arrow">&#45;&gt;</span></span> <span>int list</span>;</span></code></li><li id="type-base_func.strings_of_sname" class="def record field anchored"><a href="#type-base_func.strings_of_sname" class="anchor"></a><code><span>strings_of_sname : <span>string <span class="arrow">&#45;&gt;</span></span> <span>int list</span>;</span></code></li><li id="type-base_func.strings_of_fname" class="def record field anchored"><a href="#type-base_func.strings_of_fname" class="anchor"></a><code><span>strings_of_fname : <span>string <span class="arrow">&#45;&gt;</span></span> <span>int list</span>;</span></code></li><li id="type-base_func.persons_of_surname" class="def record field anchored"><a href="#type-base_func.persons_of_surname" class="anchor"></a><code><span>persons_of_surname : <a href="#type-string_person_index">string_person_index</a>;</span></code></li><li id="type-base_func.persons_of_first_name" class="def record field anchored"><a href="#type-base_func.persons_of_first_name" class="anchor"></a><code><span>persons_of_first_name : <a href="#type-string_person_index">string_person_index</a>;</span></code></li><li id="type-base_func.patch_person" class="def record field anchored"><a href="#type-base_func.patch_person" class="anchor"></a><code><span>patch_person : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-dsk_person">dsk_person</a> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.patch_ascend" class="def record field anchored"><a href="#type-base_func.patch_ascend" class="anchor"></a><code><span>patch_ascend : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-dsk_ascend">dsk_ascend</a> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.patch_union" class="def record field anchored"><a href="#type-base_func.patch_union" class="anchor"></a><code><span>patch_union : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-dsk_union">dsk_union</a> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.patch_family" class="def record field anchored"><a href="#type-base_func.patch_family" class="anchor"></a><code><span>patch_family : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-dsk_family">dsk_family</a> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.patch_couple" class="def record field anchored"><a href="#type-base_func.patch_couple" class="anchor"></a><code><span>patch_couple : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-dsk_couple">dsk_couple</a> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.patch_descend" class="def record field anchored"><a href="#type-base_func.patch_descend" class="anchor"></a><code><span>patch_descend : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-dsk_descend">dsk_descend</a> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.patch_name" class="def record field anchored"><a href="#type-base_func.patch_name" class="anchor"></a><code><span>patch_name : <span>string <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.insert_string" class="def record field anchored"><a href="#type-base_func.insert_string" class="anchor"></a><code><span>insert_string : <span>string <span class="arrow">&#45;&gt;</span></span> int;</span></code></li><li id="type-base_func.replace_string" class="def record field anchored"><a href="#type-base_func.replace_string" class="anchor"></a><code><span>replace_string : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> int;</span></code></li><li id="type-base_func.commit_patches" class="def record field anchored"><a href="#type-base_func.commit_patches" class="anchor"></a><code><span>commit_patches : <span>unit <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.commit_notes" class="def record field anchored"><a href="#type-base_func.commit_notes" class="anchor"></a><code><span>commit_notes : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.commit_wiznotes" class="def record field anchored"><a href="#type-base_func.commit_wiznotes" class="anchor"></a><code><span>commit_wiznotes : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li><li id="type-base_func.nb_of_real_persons" class="def record field anchored"><a href="#type-base_func.nb_of_real_persons" class="anchor"></a><code><span>nb_of_real_persons : <span>unit <span class="arrow">&#45;&gt;</span></span> int;</span></code></li><li id="type-base_func.iper_exists" class="def record field anchored"><a href="#type-base_func.iper_exists" class="anchor"></a><code><span>iper_exists : <span>int <span class="arrow">&#45;&gt;</span></span> bool;</span></code></li><li id="type-base_func.ifam_exists" class="def record field anchored"><a href="#type-base_func.ifam_exists" class="anchor"></a><code><span>ifam_exists : <span>int <span class="arrow">&#45;&gt;</span></span> bool;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Functionality part of database. Every modification of the base is stored in <i>patches</i> file. Note that, every modification firstly is pendent and should be commited to apply them and to update <i>patches</i> file with <code>commit_patches</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-base_version"><a href="#type-base_version" class="anchor"></a><code><span><span class="keyword">type</span> base_version</span><span> = </span></code><ol><li id="type-base_version.GnWb0020" class="def variant constructor anchored"><a href="#type-base_version.GnWb0020" class="anchor"></a><code><span>| </span><span><span class="constructor">GnWb0020</span></span></code></li><li id="type-base_version.GnWb0021" class="def variant constructor anchored"><a href="#type-base_version.GnWb0021" class="anchor"></a><code><span>| </span><span><span class="constructor">GnWb0021</span></span></code></li><li id="type-base_version.GnWb0022" class="def variant constructor anchored"><a href="#type-base_version.GnWb0022" class="anchor"></a><code><span>| </span><span><span class="constructor">GnWb0022</span></span></code></li><li id="type-base_version.GnWb0023" class="def variant constructor anchored"><a href="#type-base_version.GnWb0023" class="anchor"></a><code><span>| </span><span><span class="constructor">GnWb0023</span></span></code></li><li id="type-base_version.GnWb0024" class="def variant constructor anchored"><a href="#type-base_version.GnWb0024" class="anchor"></a><code><span>| </span><span><span class="constructor">GnWb0024</span></span></code></li></ol></div><div class="spec-doc"><p>Geneweb database version</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dsk_base"><a href="#type-dsk_base" class="anchor"></a><code><span><span class="keyword">type</span> dsk_base</span><span> = </span><span>{</span></code><ol><li id="type-dsk_base.data" class="def record field anchored"><a href="#type-dsk_base.data" class="anchor"></a><code><span>data : <a href="#type-base_data">base_data</a>;</span></code></li><li id="type-dsk_base.func" class="def record field anchored"><a href="#type-dsk_base.func" class="anchor"></a><code><span>func : <a href="#type-base_func">base_func</a>;</span></code></li><li id="type-dsk_base.version" class="def record field anchored"><a href="#type-dsk_base.version" class="anchor"></a><code><span>version : <a href="#type-base_version">base_version</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Database representation: data and basic requests over this data.</p></div></div></div></body></html>
